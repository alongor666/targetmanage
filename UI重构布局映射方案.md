# UI重构布局映射方案

## 📋 旧版页面构成分析

### 当前旧版页面结构（src/app/page.tsx）

1. **筛选器区域**（毛玻璃效果卡片）
   - 视角选择器（全省/同城/异地/单机构）
   - 产品选择器（汇总/车险/财产险/人身险）
   - 截至月份（1-12月）
   - 时间进度口径（线性/目标权重/2025实际）
   - 数据诊断信息（数据条数、基线值）
   - 清空缓存按钮

2. **图表区域**
   - 季度保费规划图（UniversalChart）
   - 月度保费规划图（UniversalChart）

3. **总公司目标达成预测**（蓝色背景区域）
   - 标题和说明文字
   - 4个产品的达成率汇总卡片（auto/property/life/total）
   - 当前选择产品的详细月度累计达成预测图

4. **KPI卡片区**（6个指标）
   - 年度目标
   - 截至本月目标（YTD）
   - YTD实际
   - 年度达成率
   - 时间进度达成率
   - 年累计增长率

5. **季度目标派生数据**
   - Q1-Q4 季度目标明细卡片

6. **下一步数据准备说明**
   - 数据准备指引文字

---

## 🎨 新版布局规划（基于设计方案）

### 整体布局结构
```
┌─────────────────────────────────────────────────┐
│  1. 顶部导航栏（64px）                            │
├─────────────────────────────────────────────────┤
│  2. 筛选控制区（动态高度）                        │
├─────────────────────────────────────────────────┤
│  3. 核心KPI卡片区（4列网格）                      │
├─────────────────────────────────────────────────┤
│  4. 图表展示区（2列网格）                         │
├─────────────────────────────────────────────────┤
│  5. 总公司预测区（全宽）                          │
├─────────────────────────────────────────────────┤
│  6. 扩展信息区（全宽）                            │
└─────────────────────────────────────────────────┘
```

---

## 📍 详细布局映射方案

### 1️⃣ 顶部导航栏（Navbar - 64px高度）

**设计规范**：
- 高度：64px
- 背景：#FFFFFF
- 左右边距：24px
- 激活链接：#007BFF + font-weight: 600

**内容布局**：
```
┌────────────────────────────────────────────────────────────┐
│ [Logo/标题]  首页  数据管理  导入数据  规则配置    [用户] [退出] │
└────────────────────────────────────────────────────────────┘
```

**映射内容**：
- **左侧**：
  - 系统标题："川分目标管理系统 2026"
  - 导航链接：首页、数据管理(/data)、导入数据(/import)、规则配置(/rules)

- **右侧**：
  - 数据刷新按钮
  - 用户信息（可选）
  - 退出登录按钮

---

### 2️⃣ 筛选控制区（FilterCard）

**设计规范**：
- 背景：#F8FAFC
- 内边距：16px
- 下拉框高度：36px

**布局方案**：

#### 方案A：紧凑型（推荐）
```
┌──────────────────────────────────────────────────────────────┐
│ 视角    产品    截至月份   时间进度   │  [当前筛选标签]  [操作] │
│ [下拉]  [下拉]   [下拉]    [下拉]    │  全省 汇总 6月   [刷新] │
│                                      │  2025基线: 12,345万元  │
│                                      │  数据: 2025(120) 2026(60)│
└──────────────────────────────────────────────────────────────┘
```

#### 方案B：双行型（信息更清晰）
```
┌──────────────────────────────────────────────────────────────┐
│ 第一行（筛选器）:                                              │
│ 视角 [下拉]  产品 [下拉]  截至月份 [下拉]  时间进度 [下拉]      │
│                                                               │
│ 第二行（状态信息）:                                             │
│ 当前筛选: [全省] [汇总] [6月] │ 2025基线: 12,345万元           │
│ 数据状态: 2025分月120条, 2026分月60条 │ [清空缓存] [导出] [刷新] │
└──────────────────────────────────────────────────────────────┘
```

**映射内容**：
- ✅ 视角选择器（旧版 viewKey）
- ✅ 产品选择器（旧版 product）
- ✅ 截至月份（旧版 month）
- ✅ 时间进度口径（旧版 progressMode）
- ✅ 数据诊断信息（旧版 dataDiagnostics）
- ✅ 2025年度基线（旧版 baseline2025）
- ✅ 清空缓存按钮（旧版 lsRemove）
- 🆕 导出数据按钮（新增）
- 🆕 刷新数据按钮（新增）

**推荐**: 使用**方案B**（双行型），信息层次更清晰，符合企业级仪表板设计。

---

### 3️⃣ 核心KPI卡片区（4列网格）

**设计规范**：
- 卡片圆角：8px
- 卡片内边距：24px
- 数值字号：36px, font-weight: 700
- 进度条高度：4px
- 网格间距：20px

**布局方案**：

#### 第一行（4个主要指标）
```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│ 年度目标     │ YTD实际      │ 年度达成率   │ 时间进度达成率│
│ 12,345万元   │ 9,876万元    │ 80.0%       │ 102.5%       │
│ [进度条100%] │ [进度条80%]  │ [进度条80%] │ [进度条100%] │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

**映射内容**：
- ✅ **年度目标**（kpi.annual）- 来自旧版
- ✅ **YTD实际**（actualsPeriod2026.ytd）- 来自旧版
- ✅ **年度达成率**（actualsPeriod2026.ytd / kpi.annual）- 来自旧版
- ✅ **时间进度达成率**（根据progressMode计算）- 来自旧版

#### 第二行（4个扩展指标 - 可选）
```
┌─────────────┬─────────────┬─────────────┬─────────────┐
│ YTD目标      │ 年累计增长率 │ 当月实际     │ 当季实际     │
│ 6,000万元    │ +12.5%      │ 1,234万元    │ 3,200万元    │
│ [进度条50%]  │ [进度条↗]   │ [进度条107%] │ [进度条95%]  │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

**映射内容**：
- ✅ **YTD目标**（kpi.ytdTarget）- 来自旧版
- ✅ **年累计增长率**（kpi.growthMetrics.growth_ytd_rate）- 来自旧版
- 🆕 **当月实际**（actualsPeriod2026.month）- 从旧版提取
- 🆕 **当季实际**（actualsPeriod2026.quarter）- 从旧版提取

**响应式规则**：
- 桌面端（≥1024px）：4列显示
- 平板端（768-1023px）：2列显示
- 移动端（<768px）：1列显示

---

### 4️⃣ 图表展示区（2列网格）

**设计规范**：
- 背景：#FFFFFF
- 圆角：8px
- 内边距：24px
- 图表高度：360px

**布局方案**：
```
┌───────────────────────────┬───────────────────────────┐
│ 季度保费规划               │ 月度保费规划               │
│ [柱状图 + 增长率折线]       │ [柱状图 + 增长率标签]       │
│                           │                           │
│ Q1  Q2  Q3  Q4            │ 1-12月份                  │
│ 2026规划 vs 2025实际       │ 2026规划 vs 2025实际       │
└───────────────────────────┴───────────────────────────┘
```

**映射内容**：

#### 左侧：季度保费规划图
- ✅ **数据来源**：quarterlyPremiumData（来自旧版 lines 438-475）
- ✅ **图表类型**：UniversalChart - quarterlyPremium
- ✅ **显示内容**：
  - 2026季度规划柱（蓝色 #007BFF）
  - 2025实际柱（灰色 #6C757D）
  - 增长率折线（亮蓝色 #368DCC）
  - 增长率点（颜色根据阈值：绿/灰/橙/红）

#### 右侧：月度保费规划图
- ✅ **数据来源**：monthlyPremiumData（来自旧版 lines 478-526）
- ✅ **图表类型**：UniversalChart - monthlyPremium
- ✅ **显示内容**：
  - 月度规划柱（蓝色）
  - 2025实际柱（灰色）
  - 增长率数据标签（showDataLabel: true）
  - 当前截至月份标记（currentMonth）

**响应式规则**：
- 桌面端（≥1024px）：2列并排
- 平板端/移动端（<1024px）：1列垂直堆叠

---

### 5️⃣ 总公司目标达成预测区（全宽）

**设计规范**：
- 背景：#E6F0FF（浅蓝色）或保持白色卡片
- 圆角：8px
- 内边距：24px

**布局方案**：
```
┌─────────────────────────────────────────────────────────────┐
│ 总公司目标达成预测                                            │
│ 说明：基于三级机构实际完成情况，预测对总公司目标的达成度        │
│                                                              │
│ ┌──────┬──────┬──────┬──────┐                              │
│ │ 车险  │ 财产险│ 人身险│ 汇总 │  （4个产品汇总卡片）           │
│ │ 达成率│ 达成率│ 达成率│ 达成率│                              │
│ │ 95.2%│ 88.3%│ 92.1%│ 91.5%│                              │
│ └──────┴──────┴──────┴──────┘                              │
│                                                              │
│ [当前选择产品的月度累计达成预测图]                             │
│ （折线图：累计目标线 vs 累计实际线）                           │
└─────────────────────────────────────────────────────────────┘
```

**映射内容**：
- ✅ **数据来源**：hqPrediction（来自旧版 lines 352-435）
- ✅ **标题和说明**（来自旧版 lines 703-717）
- ✅ **4个产品汇总卡片**（来自旧版 lines 720-742）
  - auto（车险）
  - property（财产险）
  - life（人身险）
  - total（汇总）
- ✅ **详细预测图表**（来自旧版 lines 745-754）
  - UniversalChart - hqPrediction
  - 显示当前选择产品的月度累计达成预测

**优化建议**：
- 4个产品卡片可以做成更紧凑的设计（小卡片或表格形式）
- 预测图表保持全宽显示，提供足够的可视化空间
- 数据来源标识（实际数据 vs 目标数据测算）要清晰提示

---

### 6️⃣ 扩展信息区（全宽）

**设计规范**：
- 背景：#FFFFFF
- 圆角：8px
- 内边距：24px

**布局方案**：
```
┌─────────────────────────────────────────────────────────────┐
│ 季度目标派生数据                                              │
│ ┌──────┬──────┬──────┬──────┐                              │
│ │  Q1  │  Q2  │  Q3  │  Q4  │                              │
│ │ 2,500│ 3,200│ 3,500│ 3,145│  万元                         │
│ └──────┴──────┴──────┴──────┘                              │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│ 下一步数据准备（严格口径）                                     │
│ • 导入 2026 月度实际后，达成率与时间进度达成率自动生效         │
│ • 导入 2025 分月基线后，增长率与增量指标自动点亮               │
└─────────────────────────────────────────────────────────────┘
```

**映射内容**：

#### 季度目标派生数据
- ✅ **数据来源**：kpi.quarterlyTargets（来自旧版 lines 787-797）
- ✅ **显示方式**：
  - 方案A：4个小卡片（现有方式）
  - 方案B：表格形式（更紧凑）
  - 方案C：横向卡片 + 进度条

#### 下一步数据准备说明
- ✅ **数据来源**：旧版 lines 799-806
- ✅ **显示方式**：
  - 信息提示卡片
  - 使用列表展示操作步骤
  - 可以添加"立即导入"快捷按钮

---

## 🎯 推荐的最终布局顺序

基于业务逻辑和用户使用流程，推荐的布局顺序：

```
1. 顶部导航栏（固定）
   ↓
2. 筛选控制区（选择视角、产品、时间）
   ↓
3. 核心KPI卡片区（第一眼看到的关键指标）
   - 年度目标、YTD实际、达成率、时间进度达成率
   ↓
4. 图表展示区（趋势和对比分析）
   - 季度保费规划图（左）+ 月度保费规划图（右）
   ↓
5. 总公司目标达成预测区（特殊业务场景）
   - 4产品汇总 + 详细预测图
   ↓
6. 扩展信息区（补充信息）
   - 季度目标派生 + 数据准备说明
```

**优先级说明**：
- **P0（最高优先级）**: 筛选控制区 + 核心KPI卡片
- **P1（高优先级）**: 季度/月度保费规划图
- **P2（中优先级）**: 总公司目标达成预测
- **P3（低优先级）**: 扩展信息区（可折叠或按需显示）

---

## 📱 响应式布局规则

### 桌面端（≥1024px）
- KPI卡片：4列网格
- 图表区域：2列并排
- 总公司预测：产品卡片4列 + 图表全宽
- 扩展信息：全宽

### 平板端（768-1023px）
- KPI卡片：2列网格
- 图表区域：1列垂直堆叠
- 总公司预测：产品卡片2列 + 图表全宽
- 扩展信息：全宽

### 移动端（<768px）
- KPI卡片：1列垂直堆叠
- 图表区域：1列垂直堆叠
- 总公司预测：产品卡片1列 + 图表全宽
- 扩展信息：简化显示或可折叠

---

## ✅ 总结：新旧映射对照表

| 旧版页面元素 | 新版布局位置 | 优先级 | 备注 |
|-------------|-------------|--------|------|
| 筛选器区域 | 区域2：筛选控制区 | P0 | 双行布局，信息更清晰 |
| 季度保费规划图 | 区域4：图表展示区（左） | P1 | 保持UniversalChart |
| 月度保费规划图 | 区域4：图表展示区（右） | P1 | 保持UniversalChart |
| 总公司目标达成预测 | 区域5：总公司预测区 | P2 | 全宽区域，优化卡片布局 |
| KPI卡片（6个） | 区域3：核心KPI卡片区 | P0 | 可扩展为8个指标（2行） |
| 季度目标派生 | 区域6：扩展信息区 | P3 | 可简化为表格形式 |
| 数据准备说明 | 区域6：扩展信息区 | P3 | 信息提示卡片 |

**关键改进点**：
1. ✅ 布局更清晰：从上到下的逻辑流程
2. ✅ 响应式完善：适配桌面/平板/移动端
3. ✅ 信息层次分明：P0核心指标优先展示
4. ✅ 视觉一致性：统一使用新的设计token
5. ✅ 交互优化：悬停效果、焦点状态、过渡动画
