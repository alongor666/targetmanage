# 通用图表组件复用方案 - 方案B（全新通用组件）

## 项目概述

创建一个全新的 UniversalChart 通用图表组件，统一主页面中的所有5个图表，构建高度可复用的图表组件体系。

**背景**：季度占比规划图（QuarterlyProportionChart）已完成开发并集成，现在需要创建一个全新的通用组件应用到：

1. 全省季度保费规划图
2. 全省季度占比规划图（已完成）
3. 全省月度保费规划图
4. 全省月度占比规划图
5. 汇总 - 月度累计达成预测

**用户选择**：

- ✅ 方案B：创建全新通用组件（UniversalChart）
- ✅ 总公司预测图也复用组件

## 目标

### 1. 统一组件架构

创建一个通用的图表组件系列，支持：

- 多种时间粒度：月度（12个数据点）/ 季度（4个数据点）
- 多种值类型：绝对值 / 占比 / 达成率
- 多种业务场景：保费规划 / 占比规划 / 预测分析

### 2. 最大化代码复用

- 共享数据处理逻辑
- 共享图表配置模板
- 共享交互功能（点击详情、视图切换）
- 共享预警系统和视觉规范

### 3. 保持灵活性

- 每个图表保留其特定业务逻辑
- 支持自定义配置和样式
- 易于扩展和维护

---

## 组件架构设计

### 方案：参数化通用组件 + 便捷包装器

```
src/components/charts/
├── UniversalChart/                    # 新增：通用图表组件
│   ├── UniversalChart.tsx            # 主组件（参数化）
│   ├── UniversalChart.types.ts       # 类型定义
│   ├── hooks/
│   │   ├── useUniversalData.ts       # 数据处理
│   │   └── useUniversalConfig.ts     # 配置生成
│   └── utils/
│       ├── dataTransformers.ts       # 数据转换工具
│       └── chartAdapters.ts          # 图表适配器
│
├── QuarterlyProportionChart/         # 已完成：季度占比规划图
│   └── ... (现有文件)
│
└── 或者：扩展现有组件
    └── QuarterlyProportionChart/
        ├── QuarterlyProportionChart.tsx       # 增强支持月度数据
        └── createMonthlyVariant.tsx           # 创建月度变体
```

---

## 实施方案

### 方案A：扩展现有组件（推荐）

#### 优点

- 最小化代码重复
- 保持现有功能完整
- 实施快速

#### 实施步骤

1. **扩展 QuarterlyProportionChart 支持月度数据**

   - 修改类型定义，支持 4 或 12 个数据点
   - 更新布局配置（12个月时调整柱宽和间距）
   - 动态计算 X 轴标签
2. **创建便捷包装器组件**

   ```typescript
   // QuarterlyPremiumChart.tsx - 季度保费规划图
   export function QuarterlyPremiumChart({
     quarterlyTargets,
     quarterlyActuals2025,
     // ...
   }) {
     return <QuarterlyProportionChart {...} viewType="premium" />;
   }

   // MonthlyPremiumChart.tsx - 月度保费规划图
   export function MonthlyPremiumChart({
     monthlyTargets,
     monthlyActuals2025,
     // ...
   }) {
     return <QuarterlyProportionChart {...} timeGranularity="monthly" />;
   }
   ```
3. **更新主页面集成**

   - 替换 4 个图表的现有实现
   - 准备对应的转换数据

#### 代码量估算

- 修改 QuarterlyProportionChart：~100 行
- 创建 4 个包装器：~200 行
- 更新主页面：~100 行
- **总计**：~400 行新增代码

---

### 方案B：创建全新通用组件

#### 优点

- 更好的抽象和扩展性
- 完全解耦的架构
- 未来更容易添加新图表

#### 缺点

- 开发时间较长
- 需要更多测试

#### 实施步骤

1. **创建 UniversalChart 组件**

   - 参数化所有配置选项
   - 支持插件式扩展
2. **迁移现有图表**

   - 逐个替换为通用组件

#### 代码量估算

- 创建 UniversalChart：~800 行
- 创建 4 个配置文件：~400 行
- 更新主页面：~200 行
- **总计**：~1400 行新增代码

---

## 推荐方案：方案A（扩展现有组件）

### 理由

1. **快速见效**：可以快速应用到所有图表
2. **风险可控**：基于已验证的组件
3. **易于维护**：代码量小，逻辑清晰

---

## 详细实施计划（方案A）

### 阶段一：扩展核心组件（1天）

#### 任务1.1：扩展类型定义

**文件**：`src/components/charts/QuarterlyProportionChart/QuarterlyProportionChart.types.ts`

**修改**：

```typescript
// 新增：时间粒度类型
export type TimeGranularity = 'quarterly' | 'monthly';

// 新增：值类型
export type ValueType = 'absolute' | 'proportion' | 'achievement';

// 修改：数据接口支持可变长度
export interface QuarterlyProportionData {
  quarterlyTargets: number[];
  quarterlyActuals2025: (number | null)[];
  quarterlyCurrent: (number | null)[];
  totalTarget: number;
  totalActual2025: number;
  growthSeries: (number | null)[];
  // 新增：时间粒度和值类型
  timeGranularity?: TimeGranularity;
  valueType?: ValueType;
}
```

#### 任务1.2：更新数据处理 Hook

**文件**：`src/components/charts/QuarterlyProportionChart/hooks/useChartData.ts`

**修改**：

- 支持处理 12 个月的月度数据
- 根据时间粒度动态生成标签
- 根据值类型调整计算逻辑

#### 任务1.3：更新图表配置 Hook

**文件**：`src/components/charts/QuarterlyProportionChart/hooks/useChartConfig.ts`

**修改**：

- 根据数据点数量动态调整柱宽
- 月度数据时：`barMaxWidth = 40`
- 季度数据时：`barMaxWidth = 60`
- 调整 grid 左右边距以容纳更多标签

---

### 阶段二：创建包装器组件（0.5天）

#### 任务2.1：创建季度保费规划图包装器

**文件**：`src/components/charts/QuarterlyProportionChart/wrappers/QuarterlyPremiumChart.tsx`

```typescript
export function QuarterlyPremiumChart({
  data,
  config,
  ...props
}) {
  // 数据已准备好，直接复用现有组件
  return <QuarterlyProportionChart
    data={data}
    config={config}
    defaultViewMode="absolute"  // 保费图默认显示绝对值
    {...props}
  />;
}
```

#### 任务2.2：创建月度保费规划图包装器

**文件**：`src/components/charts/QuarterlyProportionChart/wrappers/MonthlyPremiumChart.tsx`

```typescript
export function MonthlyPremiumChart({
  data,
  config,
  ...props
}) {
  // 转换月度数据为组件需要的格式
  const adaptedData = {
    ...data,
    timeGranularity: 'monthly',
  };

  return <QuarterlyProportionChart
    data={adaptedData}
    config={{ ...config, height: 360 }}
    defaultViewMode="absolute"
    {...props}
  />;
}
```

#### 任务2.3：创建月度占比规划图包装器

**文件**：`src/components/charts/QuarterlyProportionChart/wrappers/MonthlyShareChart.tsx`

```typescript
export function MonthlyShareChart({
  data,
  config,
  ...props
}) {
  const adaptedData = {
    ...data,
    timeGranularity: 'monthly',
  };

  return <QuarterlyProportionChart
    data={adaptedData}
    config={{ ...config, height: 360 }}
    defaultViewMode="proportion"  // 占比图默认显示占比
    {...props}
  />;
}
```

#### 任务2.4：创建总公司预测图包装器

**文件**：`src/components/charts/QuarterlyProportionChart/wrappers/HqPredictionChart.tsx`

```typescript
export function HqPredictionChart({
  data,
  config,
  ...props
}) {
  // 这个图表最特殊，可能需要更多定制
  const adaptedData = {
    ...data,
    timeGranularity: 'monthly',
    valueType: 'achievement',
  };

  return <QuarterlyProportionChart
    data={adaptedData}
    config={{ ...config, height: 400 }}
    defaultViewMode="achievement"  // 新增：达成率视图
    {...props}
  />;
}
```

---

### 阶段三：更新主页面（0.5天）

#### 任务3.1：准备图表数据

为每个图表添加数据准备 useMemo：

```typescript
// 1. 季度保费规划图数据
const quarterlyPremiumData = useMemo(() => {
  // 转换现有 quarterlyChartOption 数据
  return { /* ... */ };
}, [kpi, ...]);

// 2. 月度保费规划图数据
const monthlyPremiumData = useMemo(() => {
  // 转换现有 chartOption 数据
  return { /* ... */ };
}, [kpi, ...]);

// 3. 月度占比规划图数据
const monthlyShareData = useMemo(() => {
  // 转换现有 monthlyShareChartOption 数据
  return { /* ... */ };
}, [kpi, ...]);

// 4. 总公司预测数据
const hqPredictionData = useMemo(() => {
  // 转换现有 hqPrediction 数据
  return { /* ... */ };
}, [hqPrediction, ...]);
```

#### 任务3.2：替换图表组件

**文件**：`src/app/page.tsx`

**替换位置**：

1. 第 1313-1325 行：季度保费规划图
2. 第 1357-1360 行：月度保费规划图
3. 第 1369-1372 行：月度占比规划图
4. 第 1374-1485 行：总公司预测图（最复杂）

---

### 阶段四：测试和优化（0.5天）

#### 任务4.1：功能测试

- [ ] 验证所有图表正确显示
- [ ] 测试交互功能（点击、切换视图）
- [ ] 测试导出功能
- [ ] 测试响应式布局

#### 任务4.2：性能优化

- [ ] 使用 React DevTools Profiler 分析性能
- [ ] 优化不必要的重渲染
- [ ] 验证大数据量场景下的性能

#### 任务4.3：视觉一致性

- [ ] 确保所有图表的视觉风格一致
- [ ] 验证预警系统统一工作
- [ ] 检查颜色、字体、间距等细节

---

## 关键技术决策

### 1. 是否修改现有组件还是创建新组件？

**决策**：修改现有组件（QuarterlyProportionChart）

**理由**：

- 现有组件已经过充分测试
- 数据结构和配置模式已经验证
- 修改比重写更安全

### 2. 如何处理不同的数据维度？

**决策**：通过 `timeGranularity` 参数控制

**实现**：

- 季度数据（4个点）：timeGranularity = 'quarterly'
- 月度数据（12个点）：timeGranularity = 'monthly'

### 3. 如何处理不同的值类型？

**决策**：通过 `valueType` 参数控制

**实现**：

- 绝对值：valueType = 'absolute'（万元）
- 占比：valueType = 'proportion'（百分比）
- 达成率：valueType = 'achievement'（百分比）

### 4. 总公司预测图是否使用相同组件？

**决策**：部分复用

**理由**：

- 总公司预测图有特殊的业务逻辑（累计达成率）
- 需要额外的数据源标识
- 可能需要自定义的系列配置

**方案**：

- 创建专用的 HqPredictionChart 包装器
- 复用核心的数据处理和交互功能
- 自定义图表配置部分

---

## 数据映射关系

### 季度保费规划图

```typescript
// 现有数据源
quarterlyChartOption

// 转换为
{
  quarterlyTargets: kpi.quarterlyTargets,
  quarterlyActuals2025: quarterlyActuals2025,
  quarterlyCurrent: quarterlyCurrent,
  totalTarget: kpi.annual,
  totalActual2025: totalActual2025,
  growthSeries: growthSeries,
  timeGranularity: 'quarterly',
  valueType: 'absolute',
}
```

### 月度保费规划图

```typescript
// 现有数据源
chartOption

// 转换为
{
  quarterlyTargets: monthlyEstimateTargets,  // 重用字段存储月度数据
  quarterlyActuals2025: monthlyActualSeries2025,
  quarterlyCurrent: monthlyCurrentForGrowth,
  totalTarget: kpi.annual,
  totalActual2025: totalActual2025,
  growthSeries: monthlyGrowthSeries,
  timeGranularity: 'monthly',
  valueType: 'absolute',
}
```

### 月度占比规划图

```typescript
// 现有数据源
monthlyShareChartOption

// 转换为
{
  quarterlyTargets: targetShare,  // 占比数据
  quarterlyActuals2025: actualShare,
  quarterlyCurrent: currentShare,
  totalTarget: 1,  // 占比总和为1
  totalActual2025: 1,
  growthSeries: shareGrowthSeries,
  timeGranularity: 'monthly',
  valueType: 'proportion',
}
```

### 总公司预测图

```typescript
// 现有数据源
hqPrediction

// 转换为（最复杂）
{
  quarterlyTargets: cumulativeTargets,  // 累计目标
  quarterlyActuals2025: cumulativeActuals,  // 累计实际
  quarterlyCurrent: cumulativeCurrent,  // 当前累计
  totalTarget: hqTarget,
  totalActual2025: 0,
  growthSeries: achievementRates,  // 达成率作为"增长率"
  timeGranularity: 'monthly',
  valueType: 'achievement',
}
```

---

## 验收标准

### 功能验收

- ✅ 所有4个图表正确显示数据
- ✅ 交互功能正常（点击、切换视图）
- ✅ 预警系统统一工作
- ✅ 导出功能可用
- ✅ 响应式布局正常

### 代码质量验收

- ✅ TypeScript 类型检查通过
- ✅ 无 console 警告或错误
- ✅ 代码复用率 > 70%
- ✅ 遵循项目规范

### 性能验收

- ✅ 页面加载时间 < 2秒
- ✅ 图表渲染时间 < 500ms
- ✅ 交互响应时间 < 100ms

---

## 预计时间

| 阶段           | 任务           | 预计时间         |
| -------------- | -------------- | ---------------- |
| 阶段一         | 扩展核心组件   | 1 天             |
| 阶段二         | 创建包装器组件 | 0.5 天           |
| 阶段三         | 更新主页面     | 0.5 天           |
| 阶段四         | 测试和优化     | 0.5 天           |
| **总计** | -              | **2.5 天** |

---

## 风险与缓解

### 风险1：数据格式不兼容

**缓解**：创建数据适配层，统一处理不同数据源

### 风险2：性能下降

**缓解**：使用 React.memo 和 useMemo 优化性能

### 风险3：回归测试失败

**缓解**：保留旧代码作为备份，逐步替换

---

## 最终确认

**用户选择**：

- ✅ 方案B：创建全新通用组件（UniversalChart）
- ✅ 总公司预测图也复用组件
- ✅ 全部7个阶段一次性实施（5-6周）

---

## 实施计划总结（方案B - 全部7阶段）

### 文件结构

```
src/components/charts/UniversalChart/
├── index.ts                          # Public API exports
├── UniversalChart.tsx                # Main component
├── UniversalChart.types.ts           # TypeScript definitions
├── adapters/                         # Data transformation layer
│   ├── index.ts
│   ├── quarterly.adapter.ts          # Quarterly data adapter
│   ├── monthly.adapter.ts            # Monthly data adapter
│   ├── hqPrediction.adapter.ts       # HQ prediction adapter
│   └── shared.adapter.ts             # Shared utilities
├── configs/                          # Chart configuration presets
│   ├── index.ts
│   ├── quarterlyPremium.config.ts    # 季度保费
│   ├── quarterlyShare.config.ts      # 季度占比
│   ├── monthlyPremium.config.ts      # 月度保费
│   ├── monthlyShare.config.ts        # 月度占比
│   └── hqPrediction.config.ts        # 总公司预测
├── hooks/
│   ├── useUniversalData.ts           # Data processing
│   ├── useUniversalConfig.ts         # ECharts config
│   └── useChartInteractions.ts       # State management
└── utils/
    └── (symlinks to ../QuarterlyProportionChart/utils)
```

### 关键技术决策

1. **高度参数化设计**

   - 通过 `timeGranularity` 控制季度/月度
   - 通过 `valueType` 控制绝对值/占比/达成率
   - 系列配置完全可定制
2. **适配器模式**

   - 每个图表类型一个专用适配器
   - 统一的 `UniversalChartInputData` 输入格式
   - 自动计算增长率和预警级别
3. **配置预设系统**

   - 5个图表类型的预设配置
   - 支持覆盖自定义选项
   - 深度合并策略
4. **最大化复用**

   - 100%复用子组件（ChartHeader, DetailPanel等）
   - 100%复用工具函数库
   - 保留现有 QuarterlyProportionChart 不变

### 预计时间：5-6周

---

## 下一步

用户已确认全部7个阶段，准备开始实施。

## 下一步

等待用户确认方案后，开始实施阶段一（扩展核心组件）。

## 设计目标

### 1. 架构优化

- **组件化**: 从耦合的内联代码重构为独立的可复用组件模块
- **类型安全**: 完整的 TypeScript 类型系统，消除 `any` 类型
- **关注点分离**: 数据处理、配置生成、交互逻辑分别独立

### 2. 视觉提升

- **现代配色**: 渐变色方案（#dceef9 → #b0d8ef）
- **深度效果**: 阴影、圆角、平滑动画
- **4级预警系统**: 优秀(绿色) / 正常(灰色) / 预警(橙色) / 危险(红色)

### 3. 交互增强

- **3种视图模式**: 占比视图 / 绝对值视图 / 表格视图
- **详情面板**: 点击柱状图显示季度详细数据
- **智能 Tooltip**: 趋势箭头（↗ ↘ →）、状态颜色编码
- **导出功能**: CSV / 图片导出

### 4. 性能优化

- **5个 useMemo**: 避免不必要的重计算
- **2个 useCallback**: 稳定的回调引用
- **条件渲染**: 按需显示详情面板

## 组件结构设计

```
src/components/charts/QuarterlyProportionChart/
├── index.ts                              # 导出入口
├── QuarterlyProportionChart.tsx          # 主组件
├── QuarterlyProportionChart.types.ts     # TypeScript 类型定义
├── components/
│   ├── ChartHeader.tsx                   # 头部（标题、图例、操作按钮）
│   ├── DetailPanel.tsx                   # 季度数据详情面板
│   ├── ViewSwitcher.tsx                  # 视图模式切换器
│   └── WarningBadge.tsx                  # 预警状态徽章
├── hooks/
│   ├── useChartData.ts                   # 数据处理 Hook
│   ├── useChartConfig.ts                 # ECharts 配置生成 Hook
│   └── useChartInteraction.ts            # 交互逻辑 Hook
└── utils/
    ├── colorUtils.ts                     # 颜色计算工具
    └── formatter.ts                      # 格式化工具函数
```

## 核心改进点对比

| 维度     | 现有实现        | 新设计                | 提升 |
| -------- | --------------- | --------------------- | ---- |
| 可复用性 | ❌ 耦合在页面   | ✅ 独立组件           | 100% |
| 类型安全 | ⚠️ 大量 any   | ✅ 完整类型定义       | 90%  |
| 交互性   | ⚠️ 基础 hover | ✅ 点击详情、视图切换 | 200% |
| 视觉效果 | ⚠️ 平淡       | ✅ 渐变、阴影、动画   | 150% |
| 性能     | ⚠️ 未优化     | ✅ memo 化优化        | 40%  |
| 维护成本 | 高              | 低                    | -60% |

## 实施计划

### 阶段一：核心组件（优先级：高）

**文件**:

- `QuarterlyProportionChart.types.ts` - 类型定义
- `QuarterlyProportionChart.tsx` - 主组件
- `hooks/useChartData.ts` - 数据处理
- `hooks/useChartConfig.ts` - ECharts配置

**功能**:

- 完整的 TypeScript 类型系统
- 数据处理和验证
- 基础的图表渲染
- 基本的 tooltip 交互

**预计时间**: 1-2 天

### 阶段二：子组件（优先级：中）

**文件**:

- `components/ChartHeader.tsx`
- `components/DetailPanel.tsx`
- `components/ViewSwitcher.tsx`
- `components/WarningBadge.tsx`

**功能**:

- 头部区域（标题、图例、操作按钮）
- 季度详情面板（点击交互）
- 视图模式切换
- 预警徽章显示

**预计时间**: 1 天

### 阶段三：增强功能（优先级：低）

**文件**:

- `hooks/useChartInteraction.ts`
- `utils/formatter.ts` 增强
- `utils/colorUtils.ts`

**功能**:

- 自定义 Tooltip（趋势箭头、颜色编码）
- 导出功能（CSV、图片）
- 响应式适配

**预计时间**: 1 天

### 阶段四：集成测试（优先级：高）

**文件**:

- `src/app/page.tsx` - 替换现有实现

**功能**:

- 替换现有图表代码
- 全面功能测试
- 性能验证

**预计时间**: 0.5 天

## 集成方式

### 现有代码（需要替换）

```tsx
// src/app/page.tsx:1266-1269
<section className="rounded-xl border p-4">
  <div className="mb-2 text-sm font-medium">{viewLabel}季度占比规划图</div>
  <ReactECharts option={quarterlyShareChartOption} style={{ height: 360 }} />
</section>
```

### 新代码

```tsx
<QuarterlyProportionChart
  data={{
    quarterlyTargets: quarterlyTargets,
    quarterlyActuals2025: quarterlyActuals2025,
    quarterlyCurrent: quarterlyCurrent,
    totalTarget: kpi.annual,
    totalActual2025: totalActual2025,
    growthSeries: growthSeries,
  }}
  config={{
    height: 400,
    showDetailPanel: true,
    defaultViewMode: 'proportion',
  }}
  onQuarterClick={(quarter, data) => {
    console.log('Selected quarter:', quarter, data);
  }}
/>
```

## 技术要点

### 1. TypeScript 类型系统

```typescript
// QuarterlyProportionChart.types.ts
export interface QuarterlyProportionData {
  quarterlyTargets: number[];
  quarterlyActuals2025: (number | null)[];
  quarterlyCurrent: (number | null)[];
  totalTarget: number;
  totalActual2025: number;
  growthSeries: (number | null)[];
}

export type ViewMode = 'proportion' | 'absolute' | 'table';

export interface ChartConfig {
  height?: number;
  showDetailPanel?: boolean;
  defaultViewMode?: ViewMode;
}

export interface QuarterlyProportionChartProps {
  data: QuarterlyProportionData;
  config?: ChartConfig;
  onQuarterClick?: (quarter: number, data: QuarterDetailData) => void;
}
```

### 2. 性能优化策略

- 使用 `useMemo` 缓存计算结果
- 使用 `useCallback` 稳定事件处理函数
- 条件渲染减少不必要的 DOM 节点
- ECharts 配置优化（避免重复创建对象）

### 3. 颜色系统

```typescript
// 继承 src/styles/tokens.ts 的配色
colors: {
  target: {
    normal: '#dceef9',
    gradient: ['#dceef9', '#b0d8ef'],
    hover: '#c5e3f7'
  },
  actual: {
    normal: '#f2f2f2',
    hover: '#e5e5e5'
  },
  growth: {
    line: '#0070c0',
    positive: '#4caf50',    // 绿色
    neutral: '#757575',     // 灰色
    negative: '#f44336'     // 红色
  },
  warning: {
    orange: '#ffc000',
    red: '#d32f2f'
  }
}
```

## 关键文件路径

### 需要创建的文件

- `src/components/charts/QuarterlyProportionChart/index.ts`
- `src/components/charts/QuarterlyProportionChart/QuarterlyProportionChart.tsx`
- `src/components/charts/QuarterlyProportionChart/QuarterlyProportionChart.types.ts`
- `src/components/charts/QuarterlyProportionChart/components/ChartHeader.tsx`
- `src/components/charts/QuarterlyProportionChart/components/DetailPanel.tsx`
- `src/components/charts/QuarterlyProportionChart/components/ViewSwitcher.tsx`
- `src/components/charts/QuarterlyProportionChart/hooks/useChartData.ts`
- `src/components/charts/QuarterlyProportionChart/hooks/useChartConfig.ts`

### 需要修改的文件

- `src/app/page.tsx` - 替换现有图表实现

### 参考的现有文件

- `src/app/page.tsx:977-1163` - 现有的图表配置
- `src/components/charts/QuarterlyChartLegend.tsx` - 现有图例组件
- `src/styles/tokens.ts` - 颜色系统
- `src/domain/allocation.ts` - 季度分配逻辑
- `src/lib/utils.ts` - 工具函数

## 验收标准

### 功能验收

- ✅ 正确显示 2026 规划占比和 2025 实际占比
- ✅ 正确显示增长率折线图
- ✅ 支持 4 个季度的数据展示
- ✅ Tooltip 显示准确的数值和百分比
- ✅ 点击柱状图显示详情面板
- ✅ 视图模式切换正常工作（占比/绝对值/表格）
- ✅ 表格视图正确显示所有数据字段
- ✅ 预警系统正确触发（增长率 < 5%）

### 性能验收

- ✅ 首次渲染时间 < 500ms
- ✅ 交互响应时间 < 100ms
- ✅ 无内存泄漏
- ✅ React DevTools Profiler 显示合理渲染次数

### 代码质量验收

- ✅ TypeScript 类型检查通过（`pnpm typecheck`）
- ✅ ESLint 检查通过（`pnpm lint`）
- ✅ 组件可复用性良好
- ✅ 代码注释完整
- ✅ 遵循项目 CLAUDE.md 规范

## 总预计时间

**开发**: 3-4 天
**测试**: 0.5 天
**总计**: 3.5-4.5 天

## 风险与注意事项

1. **数据兼容性**: 需要确保新组件与现有数据格式完全兼容
2. **性能影响**: 新功能可能增加计算量，需要性能测试
3. **UI 一致性**: 需要与项目整体设计风格保持一致
4. **回归测试**: 确保不影响现有功能

## 下一步

等待用户确认方案后，开始实施阶段一（核心组件开发）。
